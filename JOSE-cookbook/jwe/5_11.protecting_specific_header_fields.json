{
    "title": "JSON Cookbook example 5.11 - Protecting specific header fields",
    "descriptoi": "RNG sequence - IV(16), CEK(32)",
    "input": {
        "plaintext": "You can trust us to stick with you through thick and thin–to the bitter end. And you can trust us to keep any secret of yours–closer than you keep it yourself. But you cannot trust us to let you face trouble alone, and go off without a word. We are your friends, Frodo.",
        "encrypt": {
            "alg": "A128GCM",
            "protected": {
                "alg": "A128GCM"
            },
            "protected_jose": {
                "enc": "A128GCM"
            },
            "unprotected_jose": {
                "alg": "A128KW",
                "kid": "81b20965-8332-43d9-a468-82160ad91ac8"
            },
            "recipients": [
                {
                    "alg": "A128KW",
                    "key": {
                        "kty": "oct",
                        "kid": "81b20965-8332-43d9-a468-82160ad91ac8",
                        "use": "enc",
                        "alg": "A128KW",
                        "k": "GZy6sIZ6wl9NJOKB-jnmVQ"
                    },
                    "unprotected": {
                        "alg": "A128KW",
                        "kid": "81b20965-8332-43d9-a468-82160ad91ac8"
                    }
                }
            ]
        },
        "rng_stream": "5A0109B034BD6E4A174379D1583804A6D06642CF68B94BC0AF3EB1EA"
    },
    "generated": {
        "cek": "WDgEptBmQs9ouUvArz6x6g",
        "iv": "WgEJsDS9bkoXQ3nR"
    },
    "encrypting_key": {
        "encrypted_key": "jJIcM9J-hbx3wnqhf5FlkEYos0sHsF0H"
    },
    "encrypting_content": {
        "protected_b64u": "eyJlbmMiOiJBMTI4R0NNIn0",
        "ciphertext": "lIbCyRmRJxnB2yLQOTqjCDKV3H30ossOw3uD9DPsqLL2DM3swKkjOwQyZtWsFLYMj5YeLht_StAn21tHmQJuuNt64T8D4t6C7kC9OCCJ1IHAolUv4MyOt80MoPb8fZYbNKqplzYJgIL58g8N2v46OgyG637d6uuKPwhAnTGm_zWhqc_srOvgiLkzyFXPq1hBAURbc3-8BqeRb48iR1-_5g5UjWVD3lgiLCN_P7AW8mIiFvUNXBPJK3nOWL4teUPS8yHLbWeL83olU4UAgL48x-8dDkH23JykibVSQju-f7e-1xreHWXzWLHs1NqBbre0dEwK3HX_xM0LjUz77Krppgegoutpf5qaKg3l-_xMINmf",
        "tag": "fNYLqpUe84KD45lvDiaBAQ"
    },
    "output": {
        "json": {
            "protected": "eyJlbmMiOiJBMTI4R0NNIn0",
            "unprotected": {
                "alg": "A128KW",
                "kid": "81b20965-8332-43d9-a468-82160ad91ac8"
            },
            "iv": "WgEJsDS9bkoXQ3nR",
            "ciphertext": "lIbCyRmRJxnB2yLQOTqjCDKV3H30ossOw3uD9DPsqLL2DM3swKkjOwQyZtWsFLYMj5YeLht_StAn21tHmQJuuNt64T8D4t6C7kC9OCCJ1IHAolUv4MyOt80MoPb8fZYbNKqplzYJgIL58g8N2v46OgyG637d6uuKPwhAnTGm_zWhqc_srOvgiLkzyFXPq1hBAURbc3-8BqeRb48iR1-_5g5UjWVD3lgiLCN_P7AW8mIiFvUNXBPJK3nOWL4teUPS8yHLbWeL83olU4UAgL48x-8dDkH23JykibVSQju-f7e-1xreHWXzWLHs1NqBbre0dEwK3HX_xM0LjUz77Krppgegoutpf5qaKg3l-_xMINmf",
            "tag": "fNYLqpUe84KD45lvDiaBAQ",
            "recipients": [
                {
                    "encrypted_key": "jJIcM9J-hbx3wnqhf5FlkEYos0sHsF0H"
                }
            ]
        },
        "json_flat": {
            "protected": "eyJlbmMiOiJBMTI4R0NNIn0",
            "unprotected": {
                "alg": "A128KW",
                "kid": "81b20965-8332-43d9-a468-82160ad91ac8"
            },
            "encrypted_key": "jJIcM9J-hbx3wnqhf5FlkEYos0sHsF0H",
            "iv": "WgEJsDS9bkoXQ3nR",
            "ciphertext": "lIbCyRmRJxnB2yLQOTqjCDKV3H30ossOw3uD9DPsqLL2DM3swKkjOwQyZtWsFLYMj5YeLht_StAn21tHmQJuuNt64T8D4t6C7kC9OCCJ1IHAolUv4MyOt80MoPb8fZYbNKqplzYJgIL58g8N2v46OgyG637d6uuKPwhAnTGm_zWhqc_srOvgiLkzyFXPq1hBAURbc3-8BqeRb48iR1-_5g5UjWVD3lgiLCN_P7AW8mIiFvUNXBPJK3nOWL4teUPS8yHLbWeL83olU4UAgL48x-8dDkH23JykibVSQju-f7e-1xreHWXzWLHs1NqBbre0dEwK3HX_xM0LjUz77Krppgegoutpf5qaKg3l-_xMINmf",
            "tag": "fNYLqpUe84KD45lvDiaBAQ"
        }
    }
}
