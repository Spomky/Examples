{
    "title": "MAC example with AES Keywrap from a direct shared secret and AES-128-CBC-MAC-64",
    "description": "This example uses features which are not defined in the spec.\n\nThis example does a MAC operation on the content using AES-CBC-MAC with 128-bit key as the digest algorithm.  The key management for the operation uses AES-KW with a 128-bit shared secret.",
    "input": {
        "plaintext": "You can trust us to stick with you through thick and thin–to the bitter end. And you can trust us to keep any secret of yours–closer than you keep it yourself. But you cannot trust us to let you face trouble alone, and go off without a word. We are your friends, Frodo.",
        "mac": {
            "alg": "AES-128-MAC-64",
            "protected": {
                "alg": "AES-128-MAC-64"
            },
            "recipients": [
                {
                    "alg": "A256KW",
                    "unprotected": {
                        "kid": "018c0ae5-4d9b-471b-bfd6-eef314bc7037"
                    },
                    "key": {
                        "kty": "oct",
                        "kid": "018c0ae5-4d9b-471b-bfd6-eef314bc7037",
                        "use": "enc",
                        "k": "hJtXIZ2uSN5kbQfbtTNWbpdmhkV8FJG-Onbc6mxCcYg"
                    }
                }
            ]
        },
        "rng_stream": "DDDC08972DF9BE62855291A17A1B4CF7"
    },
    "output": {
        "cbor": "860354A163616C676E4145532D3132382D4D41432D3634F659010D596F752063616E20747275737420757320746F20737469636B207769746820796F75207468726F75676820746869636B20616E64207468696E3F746F207468652062697474657220656E642E20416E6420796F752063616E20747275737420757320746F206B65657020616E7920736563726574206F6620796F7572733F636C6F736572207468616E20796F75206B65657020697420796F757273656C662E2042757420796F752063616E6E6F7420747275737420757320746F206C657420796F7520666163652074726F75626C6520616C6F6E652C20616E6420676F206F666620776974686F7574206120776F72642E2057652061726520796F757220667269656E64732C2046726F646F2E48474102BE6C96D5908185F6A263616C6766413235364B57636B6964782430313863306165352D346439622D343731622D626664362D656566333134626337303337F65818711AB0DC2FC4585DCE27EFFA6781C8093EBA906F227B6EB0F6",
        "cbor_flat": "8A0354A163616C676E4145532D3132382D4D41432D3634F659010D596F752063616E20747275737420757320746F20737469636B207769746820796F75207468726F75676820746869636B20616E64207468696E3F746F207468652062697474657220656E642E20416E6420796F752063616E20747275737420757320746F206B65657020616E7920736563726574206F6620796F7572733F636C6F736572207468616E20796F75206B65657020697420796F757273656C662E2042757420796F752063616E6E6F7420747275737420757320746F206C657420796F7520666163652074726F75626C6520616C6F6E652C20616E6420676F206F666620776974686F7574206120776F72642E2057652061726520796F757220667269656E64732C2046726F646F2E48474102BE6C96D590F6A263616C6766413235364B57636B6964782430313863306165352D346439622D343731622D626664362D656566333134626337303337F65818711AB0DC2FC4585DCE27EFFA6781C8093EBA906F227B6EB0F6"
    }
}
