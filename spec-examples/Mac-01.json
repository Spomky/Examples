{
    "title": "MAC example with direct ECDH static-static and HMAC-SHA256",
    "description": "This example uses features which are not defined in the spec.\n\nThis example does a MAC operation on the content using HMAC with SHA-256 as the digest algorithm.  The key management for the operation uses ECDH with curve P-256 in a static-static mode.  As such, both a nonce and apu value are specified.\n\nThe example uses a fixed random number generator to create the nonce value used.",
    "input": {
        "plaintext": "You can trust us to stick with you through thick and thin–to the bitter end. And you can trust us to keep any secret of yours–closer than you keep it yourself. But you cannot trust us to let you face trouble alone, and go off without a word. We are your friends, Frodo.",
        "mac": {
            "alg": "HS256",
            "protected": {
                "alg": "HS256"
            },
            "recipients": [
                {
                    "alg": "ECDH-SS",
                    "unprotected": {
                        "kid": "meriadoc.brandybuck@buckland.example",
                        "spk": {
                            "kid": "peregrin.took@tuckborough.example"
                        },
                        "apu_hex": "4d8553e7e74f3c6a3a9dd3ef286a8195cbf8a23d19558ccfec7d34b824f42d92bd06bd2c7f0271f0214e141fb779ae2856abf585a58368b017e7f2a9e5ce4db5"
                    },
                    "key": {
                        "kty": "EC",
                        "kid": "meriadoc.brandybuck@buckland.example",
                        "use": "enc",
                        "crv": "P-256",
                        "x": "Ze2loSV3wrroKUN_4zhwGhCqo3Xhu1td4QjeQ5wIVR0",
                        "y": "HlLtdXARY_f55A3fnzQbPcm6hgr34Mp8p-nuzQCE0Zw",
                        "d": "r_kHyZ-a06rmxM3yESK84r1otSg-aQcVStkRhA-iCM8"
                    },
                    "sender_key": {
                        "kty": "EC",
                        "crv": "P-256",
                        "use": "enc",
                        "kid": "peregrin.took@tuckborough.example",
                        "x": "mPUKT_bAWGHIhg0TpjjqVsP1rXWQu_vwVOHHtNkdYoA",
                        "y": "8BQAsImGeAS46fyWw5MhYfGTT0IjBpFw2SS34Dv4Irs",
                        "d": "AtH35vJsQ9SGjYfOsjUxYXQKrPH3FjZHmEtSKoSN8cM"
                    }
                }
            ]
        }
    },
    "output": {
        "cbor": "86034BA163616C67654853323536F659010D596F752063616E20747275737420757320746F20737469636B207769746820796F75207468726F75676820746869636B20616E64207468696E3F746F207468652062697474657220656E642E20416E6420796F752063616E20747275737420757320746F206B65657020616E7920736563726574206F6620796F7572733F636C6F736572207468616E20796F75206B65657020697420796F757273656C662E2042757420796F752063616E6E6F7420747275737420757320746F206C657420796F7520666163652074726F75626C6520616C6F6E652C20616E6420676F206F666620776974686F7574206120776F72642E2057652061726520796F757220667269656E64732C2046726F646F2E5820D89D91F59BD46E16390F26B8164CD2C34B04803ECD97102704CCD136317048CD8185F6A463616C6767454344482D5353636B696478246D65726961646F632E6272616E64796275636B406275636B6C616E642E6578616D706C656373706BA1636B69647821706572656772696E2E746F6F6B407475636B626F726F7567682E6578616D706C656361707558404D8553E7E74F3C6A3A9DD3EF286A8195CBF8A23D19558CCFEC7D34B824F42D92BD06BD2C7F0271F0214E141FB779AE2856ABF585A58368B017E7F2A9E5CE4DB5F6F6F6",
        "cbor_flat": "8A034BA163616C67654853323536F659010D596F752063616E20747275737420757320746F20737469636B207769746820796F75207468726F75676820746869636B20616E64207468696E3F746F207468652062697474657220656E642E20416E6420796F752063616E20747275737420757320746F206B65657020616E7920736563726574206F6620796F7572733F636C6F736572207468616E20796F75206B65657020697420796F757273656C662E2042757420796F752063616E6E6F7420747275737420757320746F206C657420796F7520666163652074726F75626C6520616C6F6E652C20616E6420676F206F666620776974686F7574206120776F72642E2057652061726520796F757220667269656E64732C2046726F646F2E5820D89D91F59BD46E16390F26B8164CD2C34B04803ECD97102704CCD136317048CDF6A463616C6767454344482D5353636B696478246D65726961646F632E6272616E64796275636B406275636B6C616E642E6578616D706C656373706BA1636B69647821706572656772696E2E746F6F6B407475636B626F726F7567682E6578616D706C656361707558404D8553E7E74F3C6A3A9DD3EF286A8195CBF8A23D19558CCFEC7D34B824F42D92BD06BD2C7F0271F0214E141FB779AE2856ABF585A58368B017E7F2A9E5CE4DB5F6F6F6"
    }
}
