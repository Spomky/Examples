{
   "title":"MAC example with multiple recipients",
   "input":{
     "plaintext":"This is the content.",
     "mac":{
       "alg":"HS256",
       "protected":{
         "alg":"HS256"
       },
       "recipients":[
         {
           "alg":"ECDH-ES+A128KW",
           "key":{
             "kty":"EC",
             "kid":"bilbo.baggins@hobbiton.example",
             "use":"enc",
             "crv":"P-521",
             "x":"AHKZLLOsCOzz5cY97ewNUajB957y-C-U88c3v13nmGZx6sYl_oJXu9A5RkTKqjqvjyekWF-7ytDyRXYgCF5cj0Kt",
             "y":"AdymlHvOiLxXkEhayXQnNCvDX4h9htZaCJN34kfmC6pV5OhQHiraVySsUdaQkAgDPrwQrJmbnX9cwlGfP-HqHZR1",
             "d":"AAhRON2r9cqXX1hg-RoI6R1tX5p2rUAYdmpHZoC1XNM56KtscrX6zbKipQrCW9CGZH3T4ubpnoTKLDYJ_fF3_rJt"
           }
         },
         {
           "alg":"A256KW",
           "unprotected":{
             "kid":"018c0ae5-4d9b-471b-bfd6-eef314bc7037"
           },
           "key":{
             "kty":"oct",
             "kid":"018c0ae5-4d9b-471b-bfd6-eef314bc7037",
             "use":"enc",
             "k":"hJtXIZ2uSN5kbQfbtTNWbpdmhkV8FJG-Onbc6mxCcYg"
           }
         }
       ]
     },
     "rng_stream":"2B7459201E5046E33FDB514C5E14A1B01D9893F8936335F821FCB1AFF450B226242773DB895E3E88FFE52628782CCD0C7457D91CCD1DAEE5A76C34F197DFD677E308F7620394503834DDDE67F5D823B9881A0A6A067FFAF10AC05DAE0AF7CCD07542008988899A10C6E7ABD1807D606DFD0B175399E33F62F0125A60A3315231BED1"
   },
   "intermediates":{
     "AAD":"hGNNQUNDoQEEQFRUaGlzIGlzIHRoZSBjb250ZW50Lg=="
   },
   "output":{
     "cbor_diag":"994([h'A10104', {}, h'546869732069732074686520636F6E74656E742E', h'A25BFF1B6251926C3B3314D9802831E9101FEE82F11BEC87CE622A5C10292BCE', [[h'', {1: 54, 4: h'62696C626F2E62616767696E7340686F626269746F6E2E6578616D706C65', -1: {1: 2, -1: 3, -2: h'43B12669ACAC3FD27898FFBA0BCD2E6C366D53BC4DB71F909A759304ACFB5E18CDC7BA0B13FF8C7636271A6924B1AC63C02688075B55EF2D613574E7DC242F79C3', -3: h'812DD694F4EF32B11014D74010A954689C6B6E8785B333D1AB44F22B9D1091AE8FC8AE40B687E5CFBE7EE6F8B47918A07BB04E9F5B1A51A334A16BC09777434113'}}, h'70306CBCE4B28F40CB7574B6928B5318C965B28A4E8A892D71DDBAB944FE68799BAEC290899623B1'], [h'', {1: -5, 4: h'30313863306165352D346439622D343731622D626664362D656566333134626337303337'}, h'0B2C7CFCE04E98276342D6476A7723C090DFDD15F9A518E7736549E998370695E6D6A83B4AE507BB']]])",
     "cbor":"D903E28543A10104A054546869732069732074686520636F6E74656E742E5820A25BFF1B6251926C3B3314D9802831E9101FEE82F11BEC87CE622A5C10292BCE828340A301183604581E62696C626F2E62616767696E7340686F626269746F6E2E6578616D706C6520A40102200321584143B12669ACAC3FD27898FFBA0BCD2E6C366D53BC4DB71F909A759304ACFB5E18CDC7BA0B13FF8C7636271A6924B1AC63C02688075B55EF2D613574E7DC242F79C3225841812DD694F4EF32B11014D74010A954689C6B6E8785B333D1AB44F22B9D1091AE8FC8AE40B687E5CFBE7EE6F8B47918A07BB04E9F5B1A51A334A16BC09777434113582870306CBCE4B28F40CB7574B6928B5318C965B28A4E8A892D71DDBAB944FE68799BAEC290899623B18340A2012404582430313863306165352D346439622D343731622D626664362D65656633313462633730333758280B2C7CFCE04E98276342D6476A7723C090DFDD15F9A518E7736549E998370695E6D6A83B4AE507BB"
   }
}

