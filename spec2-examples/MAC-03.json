{
   "title":"MAC example with multiple recipients",
   "input":{
     "plaintext":"This is the content.",
     "mac":{
       "alg":"HS256",
       "protected":{
         "alg":"HS256"
       },
       "recipients":[
         {
           "alg":"ECDH-ES+A128KW",
           "key":{
             "kty":"EC",
             "kid":"bilbo.baggins@hobbiton.example",
             "use":"enc",
             "crv":"P-521",
             "x":"AHKZLLOsCOzz5cY97ewNUajB957y-C-U88c3v13nmGZx6sYl_oJXu9A5RkTKqjqvjyekWF-7ytDyRXYgCF5cj0Kt",
             "y":"AdymlHvOiLxXkEhayXQnNCvDX4h9htZaCJN34kfmC6pV5OhQHiraVySsUdaQkAgDPrwQrJmbnX9cwlGfP-HqHZR1",
             "d":"AAhRON2r9cqXX1hg-RoI6R1tX5p2rUAYdmpHZoC1XNM56KtscrX6zbKipQrCW9CGZH3T4ubpnoTKLDYJ_fF3_rJt"
           }
         },
         {
           "alg":"RSA-OAEP-256",
           "key":{
             "kty":"RSA",
             "kid":"bilbo.baggins@hobbiton.example",
             "use":"enc",
             "n":"n4EPtAOCc9AlkeQHPzHStgAbgs7bTZLwUBZdR8_KuKPEHLd4rHVTeT-O-XV2jRojdNhxJWTDvNd7nqQ0VEiZQHz_AJmSCpMaJMRBSFKrKb2wqVwGU_NsYOYL-QtiWN2lbzcEe6XC0dApr5ydQLrHqkHHig3RBordaZ6Aj-oBHqFEHYpPe7Tpe-OfVfHd1E6cS6M1FZcD1NNLYD5lFHpPI9bTwJlsde3uhGqC0ZCuEHg8lhzwOHrtIQbS0FVbb9k3-tVTU4fg_3L_vniUFAKwuCLqKnS2BYwdq_mzSnbLY7h_qixoR7jig3__kRhuaxwUkRz5iaiQkqgc5gHdrNP5zw",
             "e":"AQAB",
             "d":"bWUC9B-EFRIo8kpGfh0ZuyGPvMNKvYWNtB_ikiH9k20eT-O1q_I78eiZkpXxXQ0UTEs2LsNRS-8uJbvQ-A1irkwMSMkK1J3XTGgdrhCku9gRldY7sNA_AKZGh-Q661_42rINLRCe8W-nZ34ui_qOfkLnK9QWDDqpaIsA-bMwWWSDFu2MUBYwkHTMEzLYGqOe04noqeq1hExBTHBOBdkMXiuFhUq1BU6l-DqEiWxqg82sXt2h-LMnT3046AOYJoRioz75tSUQfGCshWTBnP5uDjd18kKhyv07lhfSJdrPdM5Plyl21hsFf4L_mHCuoFau7gdsPfHPxxjVOcOpBrQzwQ",
             "p":"3Slxg_DwTXJcb6095RoXygQCAZ5RnAvZlno1yhHtnUex_fp7AZ_9nRaO7HX_-SFfGQeutao2TDjDAWU4Vupk8rw9JR0AzZ0N2fvuIAmr_WCsmGpeNqQnev1T7IyEsnh8UMt-n5CafhkikzhEsrmndH6LxOrvRJlsPp6Zv8bUq0k",
             "q":"uKE2dh-cTf6ERF4k4e_jy78GfPYUIaUyoSSJuBzp3Cubk3OCqs6grT8bR_cu0Dm1MZwWmtdqDyI95HrUeq3MP15vMMON8lHTeZu2lmKvwqW7anV5UzhM1iZ7z4yMkuUwFWoBvyY898EXvRD-hdqRxHlSqAZ192zB3pVFJ0s7pFc",
             "dp":"B8PVvXkvJrj2L-GYQ7v3y9r6Kw5g9SahXBwsWUzp19TVlgI-YV85q1NIb1rxQtD-IsXXR3-TanevuRPRt5OBOdiMGQp8pbt26gljYfKU_E9xn-RULHz0-ed9E9gXLKD4VGngpz-PfQ_q29pk5xWHoJp009Qf1HvChixRX59ehik",
             "dq":"CLDmDGduhylc9o7r84rEUVn7pzQ6PF83Y-iBZx5NT-TpnOZKF1pErAMVeKzFEl41DlHHqqBLSM0W1sOFbwTxYWZDm6sI6og5iTbwQGIC3gnJKbi_7k_vJgGHwHxgPaX2PnvP-zyEkDERuf-ry4c_Z11Cq9AqC2yeL6kdKT1cYF8",
             "qi":"3PiqvXQN0zwMeE-sBvZgi289XP9XCQF3VWqPzMKnIgQp7_Tugo6-NZBKCQsMf3HaEGBjTVJs_jcK8-TRXvaKe-7ZMaQj8VfBdYkssbu0NKDDhjJ-GtiseaDVWt7dcH0cfwxgFUHpQh7FoCrjFJ6h6ZEpMF6xmujs4qMpPz8aaI4"
           }
         },
         {
           "alg":"A256KW",
           "unprotected":{
             "kid":"018c0ae5-4d9b-471b-bfd6-eef314bc7037"
           },
           "key":{
             "kty":"oct",
             "kid":"018c0ae5-4d9b-471b-bfd6-eef314bc7037",
             "use":"enc",
             "k":"hJtXIZ2uSN5kbQfbtTNWbpdmhkV8FJG-Onbc6mxCcYg"
           }
         }
       ]
     },
     "rng_stream":"2B7459201E5046E33FDB514C5E14A1B01D9893F8936335F821FCB1AFF450B226242773DB895E3E88FFE52628782CCD0C7457D91CCD1DAEE5A76C34F197DFD677E308F7620394503834DDDE67F5D823B9881A0A6A067FFAF10AC05DAE0AF7CCD07542008988899A10C6E7ABD1807D606DFD0B175399E33F62F0125A60A3315231BED1"
   },
   "output":{
     "cbor_diag":"{1: 3, 2: h'A10104', 4: h'546869732069732074686520636F6E74656E742E', 10: h'7AAA6E74546873061F0A7DE21FF0C0658D401A68DA738DD893748651983CE1D0', 9: [{3: {1: \"ECDH-ES+A128KW\", 4: h'62696C626F2E62616767696E7340686F626269746F6E2E6578616D706C65', -1: {1: 2, -1: 3, -2: h'43B12669ACAC3FD27898FFBA0BCD2E6C366D53BC4DB71F909A759304ACFB5E18CDC7BA0B13FF8C7636271A6924B1AC63C02688075B55EF2D613574E7DC242F79C3', -3: h'812DD694F4EF32B11014D74010A954689C6B6E8785B333D1AB44F22B9D1091AE8FC8AE40B687E5CFBE7EE6F8B47918A07BB04E9F5B1A51A334A16BC09777434113'}}, 4: h'1B120C848C7F2F8943E402CBDBDB58EFB281753AF4169C70D0126C0D16436277160821790EF4FE3F'}, {3: {1: -26, 4: h'62696C626F2E62616767696E7340686F626269746F6E2E6578616D706C65'}, 4: h'46C4F88069B650909A891E84013614CD58A3668F88FA18F3852940A20B35098591D3AACF91C125A2595CDA7BEE75A490579F0E2F20FD6BC956623BFDE3029C318F82C426DAC3463B261C981AB18B72FE9409412E5C7F2D8F2B5ABAF780DF6A282DB033B3A863FA957408B81741878F466DCC437006CA21407181A016CA608CA8208BD3C5A1DDC828531E30B89A67EC6BB97B0C3C3C92036C0CB84AA0F0CE8C3E4A215D173BFA668F116CA9F1177505AFB7629A9B0B5E096E81D37900E06F561A32B6BC993FC6D0CB5D4BB81B74E6FFB0958DAC7227C2EB8856303D989F93B4A051830706A4C44E8314EC846022EAB727E16ADA628F12EE7978855550249CCB58'}, {3: {1: -5, 4: h'30313863306165352D346439622D343731622D626664362D656566333134626337303337'}, 4: h'0B2C7CFCE04E98276342D6476A7723C090DFDD15F9A518E7736549E998370695E6D6A83B4AE507BB'}]}",
     "cbor":"A501030243A101040454546869732069732074686520636F6E74656E742E0A58207AAA6E74546873061F0A7DE21FF0C0658D401A68DA738DD893748651983CE1D00983A203A3016E454344482D45532B413132384B5704581E62696C626F2E62616767696E7340686F626269746F6E2E6578616D706C6520A40102200321584143B12669ACAC3FD27898FFBA0BCD2E6C366D53BC4DB71F909A759304ACFB5E18CDC7BA0B13FF8C7636271A6924B1AC63C02688075B55EF2D613574E7DC242F79C3225841812DD694F4EF32B11014D74010A954689C6B6E8785B333D1AB44F22B9D1091AE8FC8AE40B687E5CFBE7EE6F8B47918A07BB04E9F5B1A51A334A16BC097774341130458281B120C848C7F2F8943E402CBDBDB58EFB281753AF4169C70D0126C0D16436277160821790EF4FE3FA203A201381904581E62696C626F2E62616767696E7340686F626269746F6E2E6578616D706C650459010046C4F88069B650909A891E84013614CD58A3668F88FA18F3852940A20B35098591D3AACF91C125A2595CDA7BEE75A490579F0E2F20FD6BC956623BFDE3029C318F82C426DAC3463B261C981AB18B72FE9409412E5C7F2D8F2B5ABAF780DF6A282DB033B3A863FA957408B81741878F466DCC437006CA21407181A016CA608CA8208BD3C5A1DDC828531E30B89A67EC6BB97B0C3C3C92036C0CB84AA0F0CE8C3E4A215D173BFA668F116CA9F1177505AFB7629A9B0B5E096E81D37900E06F561A32B6BC993FC6D0CB5D4BB81B74E6FFB0958DAC7227C2EB8856303D989F93B4A051830706A4C44E8314EC846022EAB727E16ADA628F12EE7978855550249CCB58A203A2012404582430313863306165352D346439622D343731622D626664362D6565663331346263373033370458280B2C7CFCE04E98276342D6476A7723C090DFDD15F9A518E7736549E998370695E6D6A83B4AE507BB"
   }
 }
